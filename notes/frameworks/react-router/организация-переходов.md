---
title: "Организация переходов"
layout: default
parent: "React Router"
nav_order: 200
---



<h1>Оглавление</h1>
- TOC
{:toc}



# Link

Link - это компонент, который используется для организации перехода на другую страницу. Когда происходит щелчок по Link, об этом узнает BrowserRouter и отрисовывает требуемый компонент.

В отличие от тега `<a>`, щелчок по Link не приводит к перезагрузке страницы. Так что для перехода между страницами в пределах приложения обычно используется именно Link.

`<a>` можно использовать, если по каким-то причинам нужно, чтобы страница перезагрузилась, либо если нужно сделать переход куда-то во внешний мир за пределами приложения.



# Переход по страницам

Переход по страницам концептуально можно разделить на два вида:

* Пользовательский. Это когда пользователь щелкнул на ссылку и перешел на нужную страницу. Реализуется с помощью компонента Link.
* Программный переход. Это когда мы в коде сами инициируем переход на какую-то страницу. Реализуется с помощью хука useNavigate.

Технически оба способа практически идентичны. Например, в обоих случаях можно делать переход с \ без перезагрузки страницы, с \ без замены в истории и т.д.

# Компонент Link

Компонент `Link` позволяет сделать кликабельную ссылку. Пользователь должен щелкнуть по ней для перехода.

```javascript
import { Link } from 'react-router-dom';
```

Пример использования:

```react
<Link to='/about'>О приложении</Link>
```

Ссылку можно стилизовать, в нее можно вкладывать другие элементы, например, картинку + подпись, а не только текст.

## Атрибуты ссылки

### to

Через атрибут `to` можно задать URL, на который надо перейти. Можно задавать в виде строки или в виде объекта:

```react
<Link to='/about'>О приложении</Link>
<Link to={{ pathname: "/about", search: "?sort=name", hash: "#team" }}>About</Link>
```

### state

Через атрибут `state` можно при переходе передать объект, который можно будет извлечь по прибытии на целевую страницу. Описано в отдельном разделе.

### reloadDocument

При наличие атрибута `reloadDocument` клик на ссылке приведет к перезагрузке страницы, как будто бы кликнули по обычному тегу `<a>`:

```react
<Link to="/about" reloadDocument>About</Link>
```

По умолчанию false, т.е. клик по ссылке не перезагружает страницу.

### replace

При наличии атрибута `replace` переход на страницу перезапишет в истории переходов последнее значение:

```react
<Link to="/about" replace>About</Link>
```

По умолчанию false, т.е. переходы собираются в стек истории и можно ходить вперед-назад по ней.

### relative

TODO

### preventScrollReset

TODO

# Программный переход, useNavigate

Программный переход реализуется с помощью хука `useNavigate`.

```javascript
import { useNavigate } from 'react-router-dom';
```

Через этот хук мы получаем в компоненте функцию навигации и с ее помощью можем перейти на нужный URL:

```react
const FoobarComponent = (props) => {
  const navigate = useNavigate();  // <-- С помощью хука получаем функцию навигации.
  const gotoArticle = (id) => navigate(`/article/${id}`);
  
  return (
  	<button onClick={() => gotoArticle(5)}>Читать пятую статью</button>  
  )
}
```

Пример просто для демонстрации синтаксиса. В нем можно было бы использовать Link. А программный переход обычно используется, когда мы имеем дело не с щелчками пользователя, а наступлением какого-либо события. Например, послали запрос на сервер, он вернул ответ и на основании этого ответа нужно автоматически перейти куда-то.





# Передача состояния при переходе

При переходе можно передать данные с текущей страницы на следующую. Это можно сделать как через компонент Link, так и через хук useNavigation. У обоих для этого есть свойство `state`, в который надо положить передаваемый объект. Для извлечения переданных данных, в целевом компоненте пользуемся хуком useLocation.

Под капотом реакт использует History API, например метод pushState, чтобы реализовать передачу.

Базовый пример:

```react
import { BrowserRouter, useLocation } from 'react-router-dom';
import { Routes, Route } from 'react-router-dom';
import { useNavigate } from 'react-router-dom';
import { Link } from 'react-router-dom';

export default function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path='/' element={<SourceComponent />} />
        <Route path='/destination' element={<DestinationComponent />} />
      </Routes>
    </BrowserRouter>
  );
}

function SourceComponent() {
  const person = {
    name: "Tom Sawyer",
    from: "Missouri"
  }

  const navigate = useNavigate();
  // <-- Заполняем св-во state что тут, что в Link
  const send = () => navigate("/destination", { state: person });

  return <>
    <button onClick={() => send()}>Перейти на другую страницу через useNavigate</button>
    <br />
    <Link to="/destination" state={person}>Перейти на другую страницу через Link</Link>
  </>
}

function DestinationComponent() {
  const location = useLocation();  // <-- Используем хук
  const data = location.state;  // <-- Извлекаем данные из свойства state

  return <div>Имя: {data.name}, Откуда: {data.from}</div>
}
```





# Перенаправление

```react
import { Navigate } from 'react-router-dom';
```

Перенаправление реализуется через компонент `<Navigate>` следующим образом, например:

```react
<Route path='*' element={<Navigate to='/notfound' replace />} />
```

TODO: почитать подробнее, как работает перенаправление, зачем тут replace и т.д.

https://stackoverflow.com/questions/74513010/what-does-the-replace-property-of-navigate-do-additionally-what-exactly-is-t



```react
import { BrowserRouter } from 'react-router-dom';
import { Routes, Route } from 'react-router-dom';
import { Link } from 'react-router-dom';
import { Navigate } from 'react-router-dom';

export default function App() {
  return (
    <BrowserRouter>
      <Menu />
      <Routes>
        <Route path='/' element={<Glagne />} />
        <Route path='/about' element={<About />} />
        <Route path='/notfound' element={<NotFound />} />
        <Route path='*' element={<Navigate to='/notfound' replace />} />
      </Routes>
    </BrowserRouter>
  );
}

// <-- Компонент навигационной панели
function Menu() {
  return (
    <div style={{ display: 'flex', columnGap: '5rem' }}>
      <Link to='/'>На главную</Link>
      <Link to='/about'>О приложении</Link>
    </div>
  )
}

// <-- Компоненты страниц
function Glagne() {
  return <h1>Это стартовая страница приложения</h1>
}

function About() {
  return <h1>Здесь можно почитать о приложении</h1>
}

function NotFound() {
  return <h1>Запрошенная страница не существует</h1>
}
```



