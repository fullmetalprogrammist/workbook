---
title: "Базовые концепци"
layout: default
parent: "Redux Toolkit"
nav_order: 100
---



# Состояние и фрагменты состояния

```javascript
// ⭐ ЦЕЛОЕ СОСТОЯНИЕ (State) - ПЛОСКАЯ СТРУКТУРА
const state = {  
  // Фрагмент "Персональная информация"
  person: {
    firstname: "Иван",
    lastname: "Иванов", 
    birthDate: "1990-01-15"
  },
  
  // Фрагмент "Контакты"
  contacts: {
    phone: "+79991234567",
    email: "ivan@mail.ru",
    address: "г. Москва, ул. Пушкина, д. 10"
  },
  
  // Фрагмент "Семья" 
  family: {
    mother: { name: "Мария Иванова" },
    father: { name: "Петр Иванов" },
    children: [
      { name: "Сергей", age: 5 }
    ]
  },
  
  // Фрагмент "Стаж"
  experience: [
    {
      company: "ООО Ромашка",
      position: "Разработчик",
      years: "2015-2020"
    },
    {
      company: "АО Лютик",
      position: "Старший разработчик", 
      years: "2020-н.в."
    }
  ]
};
```



# Действие

- Формат `domain/ACTION_NAME`

```javascript
const updateNameAction = {
  type: 'person/UPDATE_FIRSTNAME',
  payload: 'Петр'
};
```

```javascript
const addChildAction = {
  type: 'family/ADD_CHILD',
  payload: {
    name: 'Ольга',
    age: 2
  }
};
```

```javascript
const addExperienceAction = {
  type: 'experience/ADD_ITEM',
  payload: {
    company: 'ИП Васильев',
    position: 'Team Lead',
    years: '2024-н.в.'
  }
};
```





# Action creator

- Чтобы не писать руками объекты действий, не ошибиться в их именах, делаем action creator'ы:

```javascript
const updateName = (firstname) => ({  // lambda-style
  type: 'person/UPDATE_FIRSTNAME',
  payload: firstname
});
```

```javascript
function addChild(childData) {  // fd-style
  return {
    type: 'family/ADD_CHILD',
    payload: childData
  }
};
```

- И пользуемся ими в местах, где нужно создать действие:

```javascript
dispatch(updateName('Петр'));
dispatch(addChild({ name: 'Ольга', age: 2 }));
```





# Редюсер

## Редюсер для фрагмента person

```javascript
const initialState = {
  person: {
    firstname: "Иван",
    lastname: "Иванов", 
    birthDate: "1990-01-15"
  }
};
```

```javascript
const personReducer = (state = initialState.person, action) => {
  switch (action.type) {
    case 'person/UPDATE_PERSON':  // можно обновить фрагмент целиком
      return { ...state, ...action.payload };  // например, если разом меняется имя + фамилия
    
    case 'person/UPDATE_FIRSTNAME':  // а можно частями
      return { ...state, firstname: action.payload };
    
    case 'person/UPDATE_LASTNAME':
      return { ...state, lastname: action.payload };
    
    case 'person/UPDATE_BIRTHDATE':
      return { ...state, birthDate: action.payload };
    
    default:
      return state;
  }
};
```





# Корневой редюсер

## Redux

- В ванильном Redux корневой редюсер создается отдельной функцией `combineReducers`

```javascript
import { combineReducers } from 'redux';
import { createStore } from 'redux';

export const rootReducer = combineReducers({
  person: personReducer,  // <-- "Person-фрагмент" попадет в итоговое состояние в поле person
  experience: reducerExperience,  // <-- "Experience-фрагмент" попадет в поле experience
  contacts: foobar,  // <-- Просто показать, что имя поля определяет, куда попадет фрагмент, а не имя редюсера
  family: qwerty
});

const myStore = createStore(rootReducer);
```

## RTK

- В RTK корневой редюсер задается среди прочих параметров при создании хранилища

```javascript
import { configureStore } from "@reduxjs/toolkit";

const myStore = configureStore({
  reducer: { 
    person: reducerPerson,
    experience: reducerExperience
  }
});
```

