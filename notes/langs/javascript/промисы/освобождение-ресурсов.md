---
title: "Освобождение ресурсов"
layout: default
parent: "Промисы"
nav_order: 400
---





# Освобождение ресурсов

## Метод .finally

```javascript
prom.finally(onFulfilledAndRejected);
```

```javascript
prom
  .finally(() => console.log("Освобождение ресурсов"))
  .then(result => console.log(result))
  .catch(error => console.log(error.message));
```

Идейно finally нужен для выполнения каких-то общих действий, не зависящих от того, как завершился промис. Например, закрытие файлов, сетевых соединений и т.д. 

Может показаться странным, что finally() тут идет перед then. Однако технически ничего странного нет. Поскольку каждый из методов then, catch, finally тоже возвращает промис (подробнее об этом в будущих конспектах), то finally можно писать в любом месте цепочки в зависимости от того, где это надо.

finally ничего не должен возвращать, а даже если возвращает, то это значение не попадает в последующие методы. При этом finally не "глотает" полученное от предыдущего промиса значение:

```javascript
Promise.resolve(5)  // <-- Результат работы промиса - 5
  .finally(() => return 10)  // <-- Пытаемся перекрыть результат исходного промиса
  .then(result => {
    console.log(result);  // 5, т.е. finally не "проглотил" результат исходного промиса
  });
```

Подробнее о технической стороне этих методов - другом конспекте.