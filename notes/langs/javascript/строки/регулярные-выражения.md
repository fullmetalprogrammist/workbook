---
title: "Регулярные выражения"
parent: "Строки"
layout: default
nav_order: 900
---

<h1>Оглавление</h1>

- TOC
{:toc}


# Синтаксис регулярок

## Как оформлять

Регулярки обрамляются слешами `/`, для них это как кавычки для строки:

```
/^(\+7|8)\(\d{3}\)\d{3}-\d{2}-\d{2}$/   # /регулярка/флаги
```

### Регулярка фиксированная

Т.е. в ней нет динамически подставляемых значений

```javascript
if ( /^(\+7|8)\(\d{3}\)\d{3}-\d{2}-\d{2}$/.test('8(495)456-78-90') ) { ... }
```

### Регулярка с вычисляемыми значениями

В этом случае нужен конструктор:

```javascript
function findWords(text, searchWord) {
  const regex = new RegExp(`\\b${searchWord}\\b`, 'gi');
  return text.match(regex);
}
```



## Символы (что ищем)

- `\d` - цифра
  - `\D` - не цифра
- `\s` - пробельный символ (пробел, таб, перенос строки и т.д.)
  - `\S` - не пробельный символ
- `\w` - буква (большая или маленькая), цифра или _
  - Может глючить с кириллицей, в зависимости от окружения
  - Надежная альтернатива для кириллицы `[a-zA-Zа-яА-ЯёЁ0-9_]`
  - `\W` - все, что не буква, не цифра и не _
- `.` - любой символ
- `[abc]` - любой из указанных
- `[^abc]` - любой кроме указанных

Каждый пункт нужно воспринимать как ОДИН символ. Т.е. например выражение `[ab{3}]` означает "любой символ из `a`, `b`, `{`, `3`, `}`". В данном случае `{3}` это не квантификатор, а просто перечисление символов.



## Квантификаторы (сколько раз искомое повторяется)

- `{3}` - ровно 3 раза
- `{2,}` - 2 и более раза
- `{2,5}` - от 2 до 5 раз
- `+` - 1 и более раз, аналог `{1,}`
- `*` - 0 и более раз, аналог `{0,}`
- `?` - 0 или 1 раз

Пример:

```
\d{3}     // три цифры
\d*       // ноль и более цифр
\d?       // ноль или одна цифра
```

Примеры: [номер телефона](#номер-телефона)



## Позиция

- `^` - в начале строки
- `$` - в конце строки
- `\b` - на границе слова

Примеры: [номер телефона](#номер-телефона)



## Альтернатива

- `a|b` - "a" или "b"
- `(ab|cd)` - "ab" или "cd", используется группировка

Примеры: [номер телефона](#номер-телефона)



## Группировка

```
Группировка
(\(\d{3}\)|\d{3})  // либо (123), либо 123
```

```
(abc)    - обычная группа (запоминает)
(?:abc)  - группа без запоминания
(a|b)    - ИЛИ (a или b)
```

Примеры: [номер телефона](#номер-телефона)



## Диапазоны

- `[a-z]` - символы с "a" до "z"
- `[a-zA-Z]` - два диапазона
- `[a-ezx]` - диапазон плюс два отдельных символа, "a-e" или "z" или "x"

# Экранирование

TODO: грязноватый раздел, дополнять по мере практического использования

Символы, которые могут требовать экранирования, потому что имеют специальное значение:

```
.  *  +  ?  ^  $  {  }  [  ]  (  )  |  \  /
```

Экранируется слешем `\`



## Вне [ ]

Если символ находится не внутри [ ], тогда экранирование нужно всегда:

```
\.     // обычная точка (не "любой символ")
\*     // обычная звездочка (не "ноль или больше")
\+     // обычный плюс (не "один или больше")
\?     // обычный вопросик (не "ноль или один")
\[     // обычная открывающая скобка
\\     // обычный обратный слеш
```

Примеры: [номер телефона](#номер-телефона)



## Внутри [ ]

```
[[\]\\]    // найти [ или ] (экранировать только ] и \ )
[\^]       // найти ^ (только если он первый, иначе не нужно)
[-]        // найти - (только если не в середине диапазона)
```



# Флаги

todo

# Примеры

```
Задача	Пример	Решение
Проверить формат	телефон, email	/шаблон/ с ^ и $
Найти все вхождения	хештеги, слова	/шаблон/g
Извлечь данные	дата, имя	группы ( )
Заменить	формат даты	.replace() с $1
Разделить	CSV, текст	.split()
```

## Номер телефона

Напиши регулярку для проверки российского номера в форматах: `+7(123)456-78-90` или `8(123)456-78-90`

```javascript
const phones = [
  '+7(123)456-78-9',     // не хватает одной цифры в конце
  '+7(123)456-78-912',   // одна лишняя цифра в конце
  'A+7(123)456-78-912Z', // в начале и в конце есть буквы
  '8(1234)456-78-90',    // много цифр в скобках
  '7(123)456-78-90',     // нет + у семерки
  '+8(123)456-78-90',    // + с восьмеркой
  '81234567890',         // другой формат
  '+7(123)456-78-90',    // <-- ok
  '8(123)456-78-90'      // <-- ok
];


for (const phone of phones) {
  if (/регулярка/.test(phone)) {
    console.log(phone);
  }
}

```

Решение:

```javascript
/^(\+7|8)\(\d{3}\)\d{3}-\d{2}-\d{2}$/
```

Объяснение:

- `(\+7|8)` - группа с альтернативой. Либо +7, либо 8.
  - `+` экранируется, потому что вне [ ] парсер пытается рассмотреть его как квантификатор, но перед ним нет символа, поэтому синтаксическая ошибка.
- `\(\d{3}\)` - здесь скобки ( ) означают не группу, а обычные скобки, поэтому они экранированы.
  - `\d{3}` - ровно три цифры
- `\d{3}-\d{2}-\d{2}` - тире не является спецсимволом, поэтому не экранируется
- ^ и $ - это значит что вся строка целиком должна совпадать с регуляркой, а не только какая-то часть. Т.е. как бы строка должна "начинаться и заканчиваться" этой регуляркой
  - Без этого строка `A+7(123)456-78-912Z` тоже бы подошла, потому что между букв A и Z часть строки совпадает с регуляркой.