# debounce

- debounce
  - Что это
    - Это паттерн
    - ⚡В чем суть
      - Выполнить действие через заданное время после наступления *последнего* события
        - Как правило, имеется ввиду последовательность однотипных событий - прокрутка, изменение поля ввода, щелчки по кнопке
          - Т.е. если событие генерируется очень часто, то нас интересует скипнуть их обработку, и обработать только последнее
        - Пример
          - Подсказка пользователю, когда он сделал паузу в наборе текста
            - Есть поисковая строка, пользователь например ищет товар, набирает название
            - Задача - показать ему подсказки, автоматически выбрав с сервера товары, которые подходят под то, что он успел ввести
            - Пользователь может печатать быстро \ медленно, ошибаться и стирать, поэтому слать запросы на сервер при каждом изменении в поле поиска - накладно
            - Решение - слать запрос только после того как пользователь сделал паузу в наборе, например, секунда-полторы
    - ⚡Техническая реализация
      - Делается через установку и сброс таймера
      - Дебаунс - это функция, которая
        - Принимает
          - Колбэк и задержку после события
        - Возвращает
          - Функцию-обертку над колбэком
            - В обертке сбрасывается старый таймер и тут же ставится новый
            - В таймере - вызывается колбэк, т.е. нужное действие, например запрос на сервер
  - Еще практические примеры использования дебаунса
    - Проверка сложности пароля
      - Пользователь притормозил в наборе - проверяем, достаточно ли сложный пароль в данный момент
    - Автоматическое сохранение в текстовых редакторах
      - Пользователь сделал паузу при наборе текста - автоматически сохраняем текущую копию
    - TODO: заполнять по мере столкновения с интересными сценариями



# Примеры

## Подсказка пользователю, база

```javascript
// html
<input id="userSearch" />


// javascript
const userInput = document.querySelector('#userSearch');

const debouncedSearch = debounce(goSearch, 1500);  // <-- Заранее создаем обертку

userInput.addEventListener(
  'input', 
  (event) => debouncedSearch(event.target.value)  // <-- Вешаем ОБЕРТКУ на обработчик
);

function goSearch(value) {  // <-- Функция-работяга
  console.log(`Запрос поиска на сервер: ${value}`)
}

function debounce(fn, delayMs) {  // <-- Дебаунс
  let timeoutId;
  return function(...args) {  // <-- Возвращаем обертку над колбэком
    clearTimeout(timeoutId);
    timeoutId = setTimeout(() => fn.apply(this, args), delayMs);  // <-- Вызываем колбэк в таймере
  }
}
```



TODO

- Сделать более сложный пример, где на сервер реально уходит запрос, выбираются подсказки, возвращаются клиенту и отображаются